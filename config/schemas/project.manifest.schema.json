{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/your-org/DevEnvTemplate/schemas/project.manifest.schema.json",
  "title": "Project Manifest",
  "description": "Schema for project.manifest.json generated by the agent CLI",
  "type": "object",
  "required": ["version", "generatedAt", "requirements", "derived"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version for the manifest",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "generatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the manifest was generated"
    },
    "requirements": {
      "type": "object",
      "description": "User-provided requirements collected by the agent",
      "required": [
        "productType",
        "coreFeatures",
        "preferredStack",
        "deploymentTarget",
        "testingLevel",
        "governanceSensitivity",
        "needsCI",
        "needsDocker",
        "needsMonitoring",
        "teamSize"
      ],
      "properties": {
        "productType": {
          "type": "string",
          "enum": [
            "Web Application",
            "API/Microservices",
            "Mobile App",
            "Desktop Application",
            "Library/SDK",
            "CLI Tool",
            "Other"
          ],
          "description": "Type of product being built"
        },
        "coreFeatures": {
          "type": "array",
          "description": "List of core features needed",
          "items": {
            "type": "string",
            "enum": [
              "Authentication/Authorization",
              "REST API",
              "GraphQL API",
              "Web UI (Frontend)",
              "Database Integration",
              "Caching",
              "File Storage",
              "Real-time Features (WebSocket)",
              "Background Jobs/Queues",
              "Admin Panel",
              "API Documentation",
              "Monitoring/Logging",
              "Search Functionality",
              "Email/SMS Notifications"
            ]
          },
          "uniqueItems": true
        },
        "preferredStack": {
          "type": "string",
          "enum": [
            "Node.js",
            "Python",
            "Go",
            "C#/.NET",
            "Java",
            "Frontend (React/Vue/Angular)",
            "Full-stack (MERN/MEAN/etc.)",
            "Other"
          ],
          "description": "Preferred technology stack"
        },
        "deploymentTarget": {
          "type": "string",
          "enum": [
            "Cloud (AWS/GCP/Azure)",
            "Self-hosted (VPS/Dedicated)",
            "Docker Containers",
            "Kubernetes",
            "Serverless",
            "Static Hosting (Netlify/Vercel)",
            "Hybrid"
          ],
          "description": "Primary deployment target"
        },
        "testingLevel": {
          "type": "string",
          "enum": [
            "Unit tests only",
            "Unit + Integration tests",
            "Unit + Integration + E2E tests",
            "Comprehensive testing (including performance/load tests)",
            "Minimal testing (just enough to deploy)"
          ],
          "description": "Desired level of testing"
        },
        "governanceSensitivity": {
          "type": "string",
          "enum": [
            "Standard (basic security, some compliance)",
            "High (financial/healthcare data, strict compliance)",
            "Enterprise (audit trails, advanced security)",
            "Public sector (government standards)",
            "None (personal/hobby project)"
          ],
          "description": "Governance and data sensitivity level"
        },
        "needsCI": {
          "type": "boolean",
          "description": "Whether CI/CD pipeline is needed"
        },
        "needsDocker": {
          "type": "boolean",
          "description": "Whether Docker configuration is needed"
        },
        "needsMonitoring": {
          "type": "boolean",
          "description": "Whether monitoring/observability is needed"
        },
        "teamSize": {
          "type": "string",
          "enum": [
            "Solo developer",
            "Small team (2-5 developers)",
            "Medium team (6-15 developers)",
            "Large team (16+ developers)"
          ],
          "description": "Development team size"
        }
      }
    },
    "derived": {
      "type": "object",
      "description": "Automatically derived configuration from requirements",
      "required": ["features", "rationale"],
      "properties": {
        "features": {
          "type": "array",
          "description": "Features for cleanup rules and scaffolding",
          "items": {
            "type": "string",
            "enum": [
              "auth",
              "api",
              "graphql",
              "frontend",
              "database",
              "cache",
              "storage",
              "websocket",
              "jobs",
              "admin",
              "docs",
              "monitoring",
              "search",
              "notifications",
              "node",
              "python",
              "go",
              "dotnet",
              "java",
              "ci",
              "docker",
              "security",
              "compliance",
              "audit",
              "unit-tests",
              "integration-tests",
              "e2e-tests",
              "performance-tests"
            ]
          },
          "uniqueItems": true
        },
        "rationale": {
          "type": "object",
          "description": "Explanations for derived configuration",
          "properties": {
            "features": {
              "type": "string",
              "description": "Explanation of how features were derived"
            },
            "stack": {
              "type": "string",
              "description": "Explanation of stack-related derivations"
            },
            "infrastructure": {
              "type": "string",
              "description": "Explanation of infrastructure derivations"
            },
            "governance": {
              "type": "string",
              "description": "Explanation of governance derivations"
            },
            "testing": {
              "type": "string",
              "description": "Explanation of testing derivations"
            }
          }
        }
      }
    }
  }
}
